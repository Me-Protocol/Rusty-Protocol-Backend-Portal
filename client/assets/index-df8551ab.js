import{aq as Y,aP as q,aQ as z,by as G,j as e,ar as $,as as H,u as Q,b as V,X,bB as J,r as u,bC as W,h as K,F as i,I as U,J as T,T as n,M as D,C as O,l as A,G as Z,D as g,bD as ee,o as ae,$ as h}from"./index-e02a2100.js";function ie(l,r=[]){const s=Object.assign({},l);for(const c of r)c in s&&delete s[c];return s}var ne=["h","minH","height","minHeight"],S=Y((l,r)=>{const s=q("Textarea",l),{className:c,rows:f,...d}=z(l),p=G(d),a=f?ie(s,ne):s;return e.jsx($.textarea,{ref:r,rows:f,...p,className:H("chakra-textarea",c),__css:a})});S.displayName="Textarea";const le=({name:l,price:r,token:s,quantity:c,date:f,expired:d,image:p,rest:a})=>{const{root:I,bodyText:o,headText:F}=se();let _=Q();const x=V(),{isOpen:M,onOpen:L,onClose:j}=X(),[P]=J(),[y,R]=u.useState(null),[N,k]=u.useState(!1),[m,w]=u.useState(""),[v,b]=u.useState(""),{data:te,refetch:E}=W({offerId:a==null?void 0:a.offerId},{refetchOnMountOrArgChange:!0,skip:!s});async function B(){if(!v){h(x,"Please input all fields");return}if(m.split(" ").length<5){h(x,"At least five characters required");return}if(!y){h(x,"Please select a rating");return}k(!0),await P({title:v,review:m,offer_id:Number(a==null?void 0:a.offerId),rating:y}).then(t=>{var C;((C=t==null?void 0:t.data)==null?void 0:C.status)===200&&(E(),h(x,"Review submitted",5e3,"bottom-right"),j(),R(null),w(""),b(""))}).catch(t=>{console.log(t,"AddReviewToOfferErr")}).finally(()=>{k(!1)})}return e.jsxs(K,{children:[e.jsxs(i,{...I,flexDir:"row",align:"center",children:[e.jsxs(i,{w:"30%",h:"70%",flexDir:"row",align:"center",justify:"space-between",children:[e.jsx(i,{w:"100px",h:"100px",flexDir:"column",children:e.jsx(U,{objectFit:"cover",src:p})}),e.jsx(T,{}),e.jsxs(i,{flexDir:"column",w:"70%",h:"100px",children:[e.jsx(n,{...F,noOfLines:1,children:l}),e.jsx(T,{}),e.jsx(n,{...o,children:s}),e.jsxs(n,{...o,children:["Purchased: ",D(a==null?void 0:a.updatedAt).fromNow()]})]})]}),d&&e.jsxs(i,{w:"30%",h:"70%",flexDir:"column",align:"flex-end",children:[e.jsx(n,{...o,color:"dark",children:"Expires"}),e.jsx(n,{...o,children:D(a==null?void 0:a.updatedAt).format("DD MMM YYYY")})]}),e.jsxs(i,{w:"30%",h:"70%",align:"flex-end",flexDir:"column",children:[e.jsx(O,{...o,as:A,_hover:{bg:"dark"},color:"light",w:"35%",h:"30%",isDisabled:!(a!=null&&a.coupon),bg:"dark",onClick:()=>{_(`${Z}/dashboard_my_deals_details`,{state:{...a}})},children:"View details"}),e.jsx(n,{as:"button",...o,opacity:a!=null&&a.couponId?1:.4,onClick:()=>{a.couponId&&L()},children:d?"View voucher":"Leave Review"}),e.jsx(n,{as:a!=null&&a.isRedeemed?"text":"button",...o,children:a!=null&&a.isRedeemed?"Redeemed":`Status: ${a.status}`}),e.jsx(n,{as:"button",...o,children:"Buy it again"})]})]}),e.jsx(g,{}),e.jsxs(ee,{isOpen:M,onClose:j,closeOnOverlayClick:!0,children:[e.jsx(n,{mb:"24px",children:"Leave review"}),e.jsx(g,{}),e.jsxs(i,{mt:"16px",mb:"16px",flexDir:"column",justify:"center",alignItems:"center",children:[e.jsx(n,{children:"My overall rating"}),e.jsx(i,{})]}),e.jsx(g,{}),e.jsxs(i,{mt:"20px",flexDir:"column",children:[e.jsx(i,{w:"100%",children:e.jsx(ae,{variant:"outline",borderRadius:"0px",value:v,onChange:({target:t})=>b(t.value),h:"46px",placeholder:"Review headline or summary",_placeholder:{opacity:1,color:"#AFAFAF"}})}),e.jsx(i,{mt:"16px",w:"100%",flexDir:"column",children:e.jsx(S,{variant:"outline",borderRadius:"0px",value:m,onChange:({target:t})=>w(t.value),placeholder:"Write your review here. It must be at least 5 characters long.",_placeholder:{opacity:1,color:"#AFAFAF"},size:"sm"})})]}),e.jsx(i,{align:"center",mt:"24px",children:e.jsx(A,{isLoading:N,w:"100%",h:"48px",bg:"black",_hover:{bg:"dark"},onClick:()=>B(),children:e.jsx(n,{color:"white",children:"Submit"})})}),e.jsx(i,{align:"center",mt:"10px",children:e.jsx(O,{as:"button",w:"100%",h:"48px",border:"1px solid black",onClick:()=>{R(null),w(""),b(""),j()},children:e.jsx(n,{color:"black",children:"Cancel"})})})]})]})},se=()=>({root:{w:"100%",h:"150px",justify:"space-between"},headText:{fontSize:"16px"},bodyText:{fontSize:"12px",color:"#999999"}});export{le as default};
