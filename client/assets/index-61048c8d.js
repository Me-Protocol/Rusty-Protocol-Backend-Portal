import{r as s,_ as T,c as N,u as D,b as L,a as z,j as e,F as i,T as a,am as I,l as k,i as O,n as B,S as W,ak as V,C as A,b8 as G,G as H,Z as U,I as $,f as X,V as Z,b9 as q}from"./index-4302fa73.js";import J from"./index-64097767.js";import{u as K}from"./Login-c5c340c6.js";import{C as x}from"./index-48807620.js";import{I as Q}from"./index.esm-cfaad004.js";import{C as Y}from"./index-d8db85ec.js";import{P as ee,a as se}from"./chunk-I5V4ORUK-7ee0060c.js";import"./formik.esm-5e033970.js";const oe=s.lazy(()=>T(()=>import("./index-4302fa73.js").then(r=>r.cR),["assets/index-4302fa73.js","assets/index-ed5220eb.css"])),te=s.lazy(()=>T(()=>import("./index-4302fa73.js").then(r=>r.cO),["assets/index-4302fa73.js","assets/index-ed5220eb.css"])),ae=({isOpen:r,onClose:m,userId:j})=>{N();let v=D();const[f,g]=s.useState(!1),[b,_]=s.useState(!1),[w,F]=s.useState(60),[C,y]=s.useState(""),[l,P]=s.useState(""),[d,h]=s.useState(""),[c,E]=s.useState(""),[p,R]=s.useState(!1);let n=L();const o=z(),u=()=>R(!p);async function M(){try{if(l!==d)return x(n,"Invalid password","Password do not match");if(l.length<8||d.length<8)return x(n,"Invalid password","Password must be at least 8 characters");if(c.length<4)return x(n,"Invalid otp","Please provide a valid otp code");const{payload:t,error:S}=await o(G({code:c,password:l,confirmPassword:d,userId:j}));if(S)return _(!1),x(n,"Error",S==null?void 0:S.message);t&&(Y(n,"Password changed successfully",5e3),v(`${H}/login`))}catch(t){console.log(t)}finally{_(!1)}}return e.jsx(oe,{isOpen:r,onClose:m,closeOnOverlayClick:!1,modalContentStyle:{borderRadius:"10px"},children:e.jsxs(i,{flexDir:"column",py:"5px",children:[e.jsxs(i,{justifyContent:"space-between",mb:"20px",children:[e.jsx(a,{fontSize:"20px",fontWeight:"700",children:"New Password"}),e.jsx(i,{as:"button",onClick:m,children:e.jsx(Q,{size:25})})]}),e.jsx(a,{fontSize:"16px",mb:"10px",children:"Please provide your new login details"}),e.jsx(I,{placeholder:"Password",borderColor:"rgba(0, 0, 0, 0.1)",backgroundColor:"#F5F5F5",borderRadius:"10px",py:"10px",px:"20px",variant:"unstyled",w:"100%",value:l,type:p?"text":"password",onChange:({target:t})=>{P(t.value),y("")}}),e.jsx(I,{mt:"20px",placeholder:"Confirm Password",backgroundColor:"#F5F5F5",borderRadius:"10px",py:"10px",px:"20px",variant:"unstyled",w:"100%",value:d,type:p?"text":"password",onChange:({target:t})=>{h(t.value),y("")}}),e.jsx(a,{as:k,onClick:u,alignSelf:"flex-end",pt:"0px",bg:"transparent",_hover:{bg:"transparent"},children:p?"Hide":"Show"}),e.jsx(O,{w:"100%",h:"80px",children:e.jsx(ee,{onComplete:t=>{E(t)},otp:!0,placeholder:"*",children:[1,2,3,4].map(()=>e.jsx(se,{bg:"grey",borderRadius:10,borderWidth:0,w:"30%",h:"100%",_focus:{border:"1px solid #1a1e26",outline:"none",boxShadow:"none"}},B()))})}),C&&e.jsx(a,{color:"#E50000",children:C}),b&&e.jsx(W,{size:"sm",alignSelf:"flex-end",mt:"10px"}),e.jsxs(O,{fontSize:"14px",mt:"25px",children:[e.jsx(a,{children:"Did not receive OTP?"}),e.jsx(V,{opacity:f?1:.5,onClick:()=>{f&&(F(w+1),g(!1))},children:e.jsx(te,{countFrom:w,onCountdownComplete:()=>{g(!0)}})})]}),e.jsx(A,{mt:"10px",w:"100%",bg:"black",color:"white",p:"10px",borderRadius:"8px",as:k,isLoading:b,onClick:M,_hover:{bg:"black",_loading:{bg:"black"}},children:"Confirm"})]})})},re=()=>{D();const r=z(),m=L(),{isOpen:j,onOpen:v,onClose:f}=U(),{root:g,boxLeft:b,boxLogin:_,leftImg:w,loginColumn:F,boxRegister:C,head:y,desc:l,registerColumn:P}=K();s.useState("");const[d,h]=s.useState(!1),[c,E]=s.useState(""),[p,R]=s.useState("");async function n(){if(!c.includes("@"))return x(m,"Invalid email address","Please enter a valid email address");try{h(!0);const{payload:o,error:u}=await r(q({identifier:c}));if(u)return h(!1),x(m,"Error",u==null?void 0:u.message);o&&(R(o==null?void 0:o.userId),v())}catch(o){console.log(o,"SEND_RESET_CODE_ERR")}finally{h(!1)}}return e.jsxs(e.Fragment,{children:[e.jsx(i,{pos:"absolute",children:e.jsx(J,{pos:"fixed"})}),e.jsxs(i,{...g,children:[e.jsx(i,{...b,children:e.jsx($,{src:X.AuthImage,alt:"Me Protocol",...w})}),e.jsx(i,{...C,children:e.jsxs(Z,{...P,children:[e.jsx(a,{fontSize:"26px",fontWeight:"700",children:"Forgot Password?"}),e.jsx(a,{opacity:.5,fontSize:"20px",children:"Provide your login email below"}),e.jsx(I,{mt:"20px",placeholder:"Enter your email",backgroundColor:"#F5F5F5",borderRadius:"10px",py:"10px",px:"20px",variant:"unstyled",w:"100%",value:c,onChange:({target:o})=>{E(o.value)}}),e.jsx(a,{...l,children:"A reset link will be sent to your email."}),e.jsx(A,{mt:"10px",w:"100%",bg:"black",color:"white",p:"10px",borderRadius:"8px",inputMode:"email",as:k,isLoading:d,onClick:n,_hover:{bg:"black",_loading:{bg:"black"}},children:"Continue"})]})}),e.jsx(ae,{isOpen:j,onClose:f,userId:p})]})]})},me=re;export{me as default};
