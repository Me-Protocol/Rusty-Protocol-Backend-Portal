import{r as o,_,a as ke,b as Ee,N as H,u as Oe,d as q,ao as ve,ap as Re,aq as _e,ar as Le,as as ze,j as e,S as u,m as X,h as l,H as c,T as t,C as h,V as O,F as n,G as Y,z as Q,at as Z,I as v,f as J,au as Pe,q as R,ai as K,X as ee,i as Ae,A as Be,av as Ie,g as Me,B as De,aw as Fe,U as se,ax as Ve}from"./index-22a5f3d5.js";import"./index-d26e6ead.js";import Ue from"./index-d62faeb5.js";import{S as We}from"./chunk-3RSXBRAN-59d5bafe.js";import{P as Te,a as $e}from"./chunk-I5V4ORUK-e5d0d044.js";import"./formik.esm-c64eeb92.js";import"./index-04a99e83.js";import"./index-6708a58f.js";import"./ResizeObserver.es-f4289e8a.js";import"./ReactCardFlip-c764330a.js";const m=o.lazy(()=>_(()=>import("./index-22a5f3d5.js").then(i=>i.dj),["assets/index-22a5f3d5.js","assets/index-00bfa456.css"])),Ne=o.lazy(()=>_(()=>import("./index-bb02cba0.js"),["assets/index-bb02cba0.js","assets/index-22a5f3d5.js","assets/index-00bfa456.css"])),ae=o.lazy(()=>_(()=>import("./index-22a5f3d5.js").then(i=>i.dk),["assets/index-22a5f3d5.js","assets/index-00bfa456.css"])),Ge=()=>{var U,W,T,$;const i=ke(),L=Ee(),{isOpen:oe,onOpen:qe,onClose:f}=H(),{isOpen:ne,onOpen:re,onClose:z}=H();let P=Oe();const{token:j}=q(s=>s.authReducer),{setUpWallet:te,loading:ie}=ve(),{user_data:r}=q(s=>s==null?void 0:s.userReducer),{data:S,isLoading:Xe}=Re({page:1,limit:7},{refetchOnMountOrArgChange:!0}),[le]=_e(),[ce]=Le();ze();const[de,w]=o.useState(0),[A,B]=o.useState(!1),[pe,I]=o.useState(""),[M,b]=o.useState(""),[xe,D]=o.useState(!1),[F,g]=o.useState(!1),[d,V]=o.useState(""),[ue,he]=o.useState(""),[a,Ye]=o.useState({}),[C,k]=o.useState(""),{root:me,head:y,desc:p,rewardBox:fe,search:E,Box1:je,center1:we,pintf1:be}=He();async function ge(){d.includes("@")&&(D(!0),await ce({rewardId:a.id,emailCode:pe}).then(s=>{var x,N,G;if(s.error){b((N=(x=s==null?void 0:s.error)==null?void 0:x.data)==null?void 0:N.error);return}(G=s==null?void 0:s.data)!=null&&G.synced&&(se(L,"Brand connected successfully"),setTimeout(()=>{i(Ve({token:j})),I(""),V(""),g(!1),w(2)},300))}).catch(s=>{console.log(s,"SendEmailVerificationForSyncERR")}).finally(()=>{D(!1)}))}async function ye(){d.includes("@")&&(B(!0),await le({rewardId:a.id,email:d}).then(s=>{s!=null&&s.data&&(g(!0),se(L,"OTP sent successfully"))}).catch(s=>{console.log(s,"ERR")}).finally(()=>{B(!1)}))}const Se=()=>{switch(de){case 0:return e.jsxs(l,{children:[e.jsxs(n,{flexDir:"row",justify:"space-between",children:[e.jsxs(c,{...y,children:["Sync ",a==null?void 0:a.name," Rewards"]}),e.jsx(h,{as:"button",onClick:f,children:e.jsx(v,{w:"30px",h:"30px",src:J.cancel_icon})})]}),e.jsxs(n,{flexDir:"row",align:"center",justify:"space-between",py:"2%",children:[e.jsxs(h,{w:"100px",h:"100px",overflow:"hidden",children:[e.jsx(v,{borderRadius:"10px",objectFit:"contain",src:a==null?void 0:a.rewardImage}),e.jsx(ee,{...je,pos:"absolute"})]}),e.jsx(t,{...p,noOfLines:4,w:"100%",pl:"3%",children:a==null?void 0:a.description})]}),e.jsx(c,{...y,children:"What you’ll get"}),e.jsx(n,{flexDir:"column",bg:"#f6f6f6",p:"5%",borderRadius:"15px",children:[`Authorize Me app to access your reward balance with ${a==null?void 0:a.brandName}`,`Me app will Read reward balance from ${a==null?void 0:a.brandName}`,"Me app will monitor changes in reward balance "].map(s=>e.jsxs(n,{children:[e.jsx(h,{...we,children:e.jsx(Be,{as:Ie,color:"light"})}),e.jsx(t,{...p,noOfLines:2,pl:"2%",w:"100%",children:s})]},R()))}),e.jsx(m,{isLoading:A,onClick:()=>w(1),name:`Connect with ${(a==null?void 0:a.rewardName)||"reward"}`})]});case 1:return e.jsxs(l,{children:[e.jsxs(n,{flexDir:"row",justify:"space-between",children:[e.jsx(c,{...y,children:"Verify identity "}),e.jsx(h,{as:"button",onClick:()=>{w(0),f(),k(""),g(!1),b("")},children:e.jsx(v,{src:J.cancel_icon,w:"30px",h:"30px"})})]}),e.jsx(t,{...p,w:"100%",pt:"1%",children:"Please select your preferred means of identification from the available options below"}),e.jsx(n,{...E,children:e.jsx(Pe,{my:"5px",children:e.jsx(We,{color:"dark",onChange:({target:s})=>{k(s.value)},value:C,variant:"unstyled",placeholder:"Select verification option",size:"md",_placeholder:{color:"#999999"},children:["Email","Phone number"].map(s=>e.jsx("option",{value:s,children:s},R()))})})}),C&&e.jsx(l,{children:C==="Email"?e.jsx(K,{...E,value:d,onChange:s=>{V(s.target.value)},placeholder:"Enter email address"}):e.jsx(K,{...E,value:ue,onChange:s=>{he(s.target.value)},placeholder:"Enter phone number"})}),F&&e.jsxs(ee,{my:"3%",children:[e.jsx(t,{fontSize:"10px",children:"Please provide the OTP sent to your inbox"}),e.jsx(Ae,{w:"100%",h:"60px",children:e.jsx(Te,{onComplete:s=>{I(s),b("")},otp:!0,placeholder:"*",children:[1,2,3,4,5,6].map(()=>e.jsx($e,{...be},R()))})})]}),M&&e.jsx(t,{...p,color:"red",children:M}),e.jsx(m,{isLoading:xe||A,onClick:()=>{if(F){ge();return}ye()},isDisabled:!d.includes("@"),name:"Continue"})]});case 2:return e.jsx(l,{w:"100%",children:e.jsxs(O,{children:[e.jsx(Q,{style:{width:"150px",height:"150px"},animationData:Z,loop:!1,autoplay:!0}),e.jsx(c,{fontSize:"18px",pb:"10px",children:"Brand connected successfully"}),e.jsx(m,{name:"Ok",onClick:()=>{w(0),f(),k(""),g(!1),b(""),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}})]})})}},Ce=async()=>{try{const s=await te({persist:!1});s.publicAddress&&await Me.put(`${De}/customer/setup-wallet-address`,{walletAddress:s.publicAddress},{headers:{Authorization:`Bearer ${j}`}}).then(({data:x})=>{j&&i(Fe({token:j})),re()}).catch(x=>{console.log(x,"UPDATeYUSERZRR")})}catch(s){console.log(s,"CREATE_WALLET ERR")}};return e.jsx(e.Fragment,{children:e.jsxs(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:[e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(Ne,{pos:"relative"})}),e.jsx(X,{children:e.jsxs(l,{mt:"3rem",...me,w:"100%",children:[e.jsx(c,{...y,children:"Let’s sync your account with brands on our network"}),e.jsx(t,{...p,children:"Connect your favorite brands to import rewards and get exclusive deals."}),e.jsxs(h,{as:O,...fe,children:[e.jsx(n,{w:{base:"90%",md:"65%"},flexDir:"column",align:"center",children:e.jsx(X,{alignSelf:"center",children:e.jsx(n,{w:"100%",display:{base:"none",md:"flex"},flexDir:"column",mt:5,alignSelf:"center",children:e.jsx(n,{children:e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(Ue,{brandsItems:(U=S==null?void 0:S.data)==null?void 0:U.brands})})})})})}),e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(m,{isDisabled:!!((W=r==null?void 0:r.customer)!=null&&W.walletAddress),rest:{w:{base:"90%",md:"50%"},mt:"30px"},isLoading:ie,name:"Proceed",onClick:Ce})}),e.jsx(n,{w:{base:"90%",md:"50%"},justifyContent:"center",onClick:()=>P(`${Y}/dashboard`),color:((T=r==null?void 0:r.customer)==null?void 0:T.walletAddress)??"placeholderColor",_hover:{color:"dark"},children:($=r==null?void 0:r.customer)!=null&&$.walletAddress?e.jsxs(t,{fontSize:{base:"14px",md:"16px"},children:["You have already synced your rewards."," ",e.jsxs(t,{as:"button",_hover:{color:"dark"},color:"placeholderColor",fontSize:{base:"14px",md:"16px"},children:[" ","Go to dashboard"]})]}):e.jsx(t,{as:"button",fontSize:{base:"14px",md:"16px"},children:"Do it later"})})]})]})}),e.jsx(ae,{isOpen:oe,onClose:f,closeOnOverlayClick:!1,children:Se()}),e.jsx(ae,{isOpen:ne,onClose:z,closeOnOverlayClick:!0,children:e.jsx(l,{w:"100%",children:e.jsxs(O,{children:[e.jsx(Q,{style:{width:"150px",height:"150px"},animationData:Z,loop:!1,autoplay:!0}),e.jsx(c,{fontSize:"18px",pb:"10px",children:"Successful"}),e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(m,{name:"Ok",onClick:async()=>{P(`${Y}/dashboard`),z()}})})]})})})]})})},ts=Ge,He=()=>({root:{w:"100%",pt:"3%",overflow:"hidden"},head:{fontSize:{base:"18px",md:"20px"}},desc:{pb:"5px",fontSize:{base:"12px",md:"14px"},w:{base:"100%",md:"80%"}},smallerDesc:{fontSize:{base:"10px",md:"14px"}},rewardBox:{w:"100%",bg:"grey",borderRadius:10,borderWidth:1,borderColor:"placeholderColor",borderStyle:"dashed",py:"10%"},connectButton:{w:{base:"65%",md:"90%"},color:"dark",borderWidth:0,backgroundColor:"light",alignSelf:"center",justifySelf:"center"},connectedButton:{w:{base:"65%",md:"35%"},color:"light",borderWidth:1,backgroundColor:"transparent"},search:{w:"100%",h:"40px",background:"#F6F6F6",borderRadius:"53px",justify:"flex-start",align:"center",pl:"2%",borderWidth:"0px",_placeholder:{color:"#999999"},_focus:{borderColor:"black"}},Box1:{w:"100px",h:"100px",borderRadius:"100px",bg:"#9999992D"},center1:{bg:"#000000",w:"20px",h:"20px",borderRadius:"20px"},pintf1:{bg:"grey",borderRadius:10,borderWidth:0,w:"15%",h:"100%"}});export{ts as default};
