import{u as G,b as z,A as M,c as U,r,ag as W,d as X,g as h,B as j,a1 as E,j as t,F as V,a2 as H,m as w,h as Q,i as F,U as L,T as y,P as Y,O as R,Q as u,G as _,y as $,S as b,C as q,l as J,W as K}from"./index-3e391fce.js";import{F as Z}from"./index.esm-ca6dc027.js";import C from"./index-8b4096f8.js";import ss from"./index-83324948.js";const ts=()=>{let x=G();const{root:A,loadMore:P}=as();let m=z();M();const{state:e}=U();r.useState([]);const[n,g]=r.useState([]);r.useState(!1);const[d,T]=r.useState(1),[k,f]=r.useState(!1),[os,v]=r.useState(1),[S,p]=r.useState(!1),[I,rs]=r.useState(W.POPULAR),{token:D,session_id:O}=X(s=>s==null?void 0:s.authReducer);r.useEffect(()=>{e?B():N()},[d]);async function B(){var s,o,i,c;p(!0),f(!1);try{const{data:a}=await h.get(`${j}/store/offer?page=${d}&limit=8&orderBy=MOST_VIEWED&sort=${e||I}`,{headers:{Authorization:`Bearer ${D}`}});((s=a==null?void 0:a.data)==null?void 0:s.offers.length)<1&&(f(!0),E(m,"No more offer available",3e3,"top")),g([...n,...(o=a==null?void 0:a.data)==null?void 0:o.offers]),v((c=(i=a==null?void 0:a.data)==null?void 0:i.pagination)==null?void 0:c.totalPage)}catch(a){console==null||console.log(a,"GET_ALL_OFFERS_ERR")}finally{p(!1)}}async function N(){var s;p(!0),f(!1);try{const{data:o}=await h.get(`${j}/views/recently-viewed/${O}?page=${d}&limit=8`);((s=o==null?void 0:o.data)==null?void 0:s.length)<1&&(f(!0),E(m,"No more offer available",3e3,"top")),g([...n,...o==null?void 0:o.data])}catch(o){console==null||console.log(o,"GET_ALL_OFFERS_ERR")}finally{p(!1)}}return t.jsxs(V,{flexDir:"column",children:[t.jsx(H,{}),t.jsx(w,{children:t.jsxs(Q,{...A,children:[t.jsxs(F,{as:"button",onClick:()=>x(-1),children:[t.jsx(L,{as:Z,w:"2vw",h:"2vw"}),t.jsx(y,{children:"Back"})]}),t.jsx(w,{children:t.jsxs(F,{mt:"20px",children:[t.jsx(Y,{}),t.jsx(y,{fontSize:["18px","18px"],textTransform:"uppercase",children:e==null?void 0:e.replaceAll("_"," ")})]})}),e&&t.jsx(t.Fragment,{children:t.jsx(R,{columns:[2,2,3,4,4],spacingX:["35px","35px","35px","15px","35px"],w:"100%",children:n==null?void 0:n.map((s,o)=>{var i,c,a,l;return t.jsx(C,{isLoaded:!0,productTitle:s==null?void 0:s.name,points:`${s==null?void 0:s.tokens}${(i=s==null?void 0:s.reward)==null?void 0:i.rewardSymbol}`,productSubtitle:(a=(c=s==null?void 0:s.product)==null?void 0:c.category)==null?void 0:a.name,price:(l=s==null?void 0:s.originalPrice)==null?void 0:l.toLocaleString(),isNew:u(u()).diff(s==null?void 0:s.createdAt,"days")<1,rest:{...s},i:o,bgImage:s==null?void 0:s.offerImages,onClick:()=>x(`${_}/productDetails/${s==null?void 0:s.offerCode}`)},$())})})}),!e&&t.jsx(t.Fragment,{children:S?t.jsx(ss,{}):t.jsx(R,{columns:[2,2,3,4,4],w:"100%",spacingX:"3.5%",mt:"40px",children:t.jsx(r.Suspense,{fallback:t.jsx(b,{size:"sm"}),children:n==null?void 0:n.map((s,o)=>{var i,c,a,l;return t.jsx(C,{isLoaded:!0,productTitle:s==null?void 0:s.name,points:`${s==null?void 0:s.tokens}${(i=s==null?void 0:s.reward)==null?void 0:i.rewardSymbol}`,productSubtitle:(a=(c=s==null?void 0:s.product)==null?void 0:c.category)==null?void 0:a.name,price:(l=s==null?void 0:s.originalPrice)==null?void 0:l.toLocaleString(),isNew:u(u()).diff(s==null?void 0:s.createdAt,"days")<1,rest:{...s},i:o,bgImage:s==null?void 0:s.offerImages,onClick:()=>x(`${_}/productDetails/${s==null?void 0:s.offerCode}`)},$())})})})}),e&&t.jsx(t.Fragment,{children:!k&&t.jsx(q,{as:J,...P,onClick:()=>{T(d+1)},children:S?t.jsx(b,{size:"sm"}):t.jsxs(t.Fragment,{children:["Load more ",t.jsx(L,{as:K,ml:"5%"})]})})})]})})]})},ls=ts,as=()=>({root:{w:"100%",mt:"108px",pt:"3%",overflow:"hidden",pb:"2%"},loadMore:{w:"132px",h:"32px",alignSelf:"center",py:"10px",borderRadius:"100px"}});export{ls as default};
