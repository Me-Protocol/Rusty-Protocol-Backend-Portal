import{u as T,a as V,c as A,r as t,j as e,F as n,I as D,f as H,h as U,H as _,T as d,i as G,n as W,L as N,g as y,B as L,s as O,k as X,G as P}from"./index-d1513471.js";import Y from"./index-78b061fc.js";import q from"./index-475e86e8.js";import{u as z}from"./Login-baa1d517.js";import{P as J,a as K}from"./chunk-I5V4ORUK-3a25ad6f.js";import"./formik.esm-d4019cef.js";import"./index.esm-cdcb8747.js";const Q=()=>{let l=T();const h=V(),{state:o}=A(),{root:w,boxLeft:C,boxLogin:S,leftImg:E,loginColumn:F,head:$,desc:r}=z();t.useState(!0);const[a,u]=t.useState(""),[B,p]=t.useState(!1),[x,g]=t.useState("");t.useEffect(()=>{},[]);async function M(){var i,f,m,j,I,k,v,b;if(!(a.length<5)){p(!0);try{const{data:s}=await y.post(`${L}/users/phone/verify`,{userId:(f=(i=o==null?void 0:o.state)==null?void 0:i.user)==null?void 0:f.userId,phone:o==null?void 0:o.value,phoneCode:a});if((m=s==null?void 0:s.isVerified)!=null&&m.token&&s){h(O(s==null?void 0:s.isVerified)),h(X({token:(j=s==null?void 0:s.isVerified)==null?void 0:j.token}));let R={method:"get",url:`${L}/pointregistry`,headers:{"x-access-token":`${(I=s==null?void 0:s.isVerified)==null?void 0:I.token}`}};const{data:c}=await y(R);((k=c==null?void 0:c.userPoints)==null?void 0:k.length)<1?l(`${P}/syncRewards`):l(`${P}/dashboard`)}}catch(s){g((b=(v=s==null?void 0:s.response)==null?void 0:v.data)==null?void 0:b.error)}finally{p(!1),u("")}}}return e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsxs(n,{...w,children:[e.jsx(n,{...C,children:e.jsx(D,{src:H.AuthImage,alt:"Me Protocol",...E})}),e.jsx(n,{...S,children:e.jsxs(U,{...F,w:{base:"70vw",md:"40vw"},children:[e.jsx(_,{...$,pb:2,children:"We sent you a verification code"}),e.jsx(d,{...r,children:"You have to give it back, though."}),e.jsx(G,{w:"100%",h:"60px",children:e.jsx(J,{onComplete:i=>{u(i),g("")},otp:!0,placeholder:"*",children:[1,2,3,4,5,6].map(()=>e.jsx(K,{bg:"grey",borderRadius:10,borderWidth:0,w:"14%",h:"100%"},W()))})}),x&&e.jsx(d,{...r,color:"red",children:x}),e.jsx(n,{w:"35vMax",children:e.jsx(Y,{isLoading:B,onClick:M,isDisabled:a.length<5,name:"That's the code"})}),e.jsxs(d,{...r,pt:"10px",children:["Didnâ€™t receive the code?"," ",e.jsxs(N,{href:"#",textDecoration:"underline",children:[" ","Send it again."]})]})]})})]})]})},re=Q;export{re as default};
