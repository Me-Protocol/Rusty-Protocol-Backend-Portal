import{r as o,_ as F,u as P,b as v,g as G,B as z,j as s,v as I,h as V,F as y,i as H,P as X,H as B,w as J,S as d,C as _,G as b,x as M,y as R,n as N,V as U,z as W,A as q,T as K,l as Q,E as Y,J as Z,t as ss}from"./index-4224d7bb.js";import{D as es}from"./index-a5654612.js";o.lazy(()=>F(()=>import("./index-4224d7bb.js").then(c=>c.d9),["assets/index-4224d7bb.js","assets/index-56f23032.css"]));const as=o.lazy(()=>F(()=>import("./index-ab27bb6a.js"),["assets/index-ab27bb6a.js","assets/index-4224d7bb.js","assets/index-56f23032.css"])),ns=({categoryName:c,category_id:p,HeaderShown:$=!0,rest:k,loaded:w,selectedBrandId:x,selectedSortId:r})=>{let g=P();v();const{nameStyles:C,button:ts,seeAllStyles:L,loadMore:A}=ss(),[u,m]=o.useState(1),[t,j]=o.useState([]);o.useState(!1);const[T,S]=o.useState(!1);o.useState(1);const[h,E]=o.useState(!1);o.useEffect(()=>{D()},[u,x,r,p]);async function D(){var e,f,n,i;E(!0),S(!1),console.log(r);try{const{data:a}=await G.get(`${z}/store/offer?page=${u}&limit=8&category=${p}${x?`&brandId=${x}`:""}${r?`&sort=${r}`:""}`);if(((e=a==null?void 0:a.data)==null?void 0:e.offers.length)<1&&S(!0),t.every(l=>(l==null?void 0:l.categoryId)===p))j(x||r?[...(f=a==null?void 0:a.data)==null?void 0:f.offers]:[...t,...(n=a==null?void 0:a.data)==null?void 0:n.offers]);else{m(1);let l=(i=a==null?void 0:a.data)==null?void 0:i.offers.map(O=>({...O,categoryId:p}));j(l)}}catch(a){console.log(a,"GET_CATEGORIES_OFFERS_ERR")}finally{E(!1)}}return(t==null?void 0:t.length)<=0,s.jsx(I,{mb:["20px","10px"],borderRadius:"20px",isLoaded:w,children:s.jsxs(V,{children:[$&&s.jsxs(y,{w:"100%",pt:"20px",children:[s.jsxs(H,{children:[s.jsx(X,{}),s.jsx(B,{...C,children:c})]}),s.jsx(J,{}),s.jsx(o.Suspense,{fallback:s.jsx(d,{size:"sm"}),children:s.jsx(_,{bg:"dark",color:"white",px:"15px",py:"5px",as:"button",onClick:()=>g(`${b}/dashboard/category/${c}`,{state:k}),...L,children:"SEE ALL OFFERS"})})]}),s.jsx(M,{display:["none","grid"],columns:[2,2,3,4,4],spacingX:["35px","35px","35px","15px","35px"],w:"100%",children:s.jsx(o.Suspense,{fallback:s.jsx(d,{size:"sm"}),children:t==null?void 0:t.map((e,f)=>{var n,i,a;return s.jsx(as,{isLoaded:!h||!!t,productTitle:e.name,points:`${e==null?void 0:e.tokens}${(n=e.reward)==null?void 0:n.rewardSymbol}`,productSubtitle:(a=(i=e.product)==null?void 0:i.category)==null?void 0:a.name,price:e.originalPrice,isNew:R(R()).diff(e==null?void 0:e.createdAt,"days")<1,rest:{...e},i:f,bgImage:e==null?void 0:e.offerImages,onClick:()=>g(`${b}/product-details/${e.offerCode}`)},N())})})}),s.jsx(es,{loadedOffers:t,offersFetching:h}),t.length<1&&s.jsxs(U,{children:[s.jsx(y,{w:"500px",h:"300px",children:s.jsx(W,{animationData:q,loop:!0,autoplay:!0,width:50,height:70})}),s.jsx(K,{children:"There were no offers found."})]}),!T&&s.jsx(_,{as:Q,...A,onClick:()=>{m(u+1)},children:h?s.jsx(d,{size:"sm"}):s.jsxs(s.Fragment,{children:["Load more ",s.jsx(Y,{as:Z,ml:"5%"})]})})]})})};export{ns as O};
