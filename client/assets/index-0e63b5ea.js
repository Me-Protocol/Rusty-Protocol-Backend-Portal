import{aq as B,aP as Y,aQ as z,by as G,j as e,ar as $,as as H,u as Q,b as V,X,bB as J,r as u,bC as W,h as K,F as i,I as U,J as T,T as n,M as D,C as O,l as S,G as Z,D as R,bD as ee,o as ae,$ as h}from"./index-e858156d.js";function ie(l,c=[]){const o=Object.assign({},l);for(const r of c)r in o&&delete o[r];return o}var ne=["h","minH","height","minHeight"],A=B((l,c)=>{const o=Y("Textarea",l),{className:r,rows:f,...d}=z(l),p=G(d),a=f?ie(o,ne):o;return e.jsx($.textarea,{ref:c,rows:f,...p,className:H("chakra-textarea",r),__css:a})});A.displayName="Textarea";const te=require("react-star-rating-component"),re=({name:l,price:c,token:o,quantity:r,date:f,expired:d,image:p,rest:a})=>{const{root:I,bodyText:s,headText:F}=oe();let _=Q();const x=V(),{isOpen:M,onOpen:L,onClose:j}=X(),[P]=J(),[m,w]=u.useState(null),[N,C]=u.useState(!1),[v,b]=u.useState(""),[g,y]=u.useState(""),{data:se,refetch:E}=W({offerId:a==null?void 0:a.offerId},{refetchOnMountOrArgChange:!0,skip:!o});async function q(){if(!g){h(x,"Please input all fields");return}if(v.split(" ").length<5){h(x,"At least five characters required");return}if(!m){h(x,"Please select a rating");return}C(!0),await P({title:g,review:v,offer_id:Number(a==null?void 0:a.offerId),rating:m}).then(t=>{var k;((k=t==null?void 0:t.data)==null?void 0:k.status)===200&&(E(),h(x,"Review submitted",5e3,"bottom-right"),j(),w(null),b(""),y(""))}).catch(t=>{console.log(t,"AddReviewToOfferErr")}).finally(()=>{C(!1)})}return e.jsxs(K,{children:[e.jsxs(i,{...I,flexDir:"row",align:"center",children:[e.jsxs(i,{w:"30%",h:"70%",flexDir:"row",align:"center",justify:"space-between",children:[e.jsx(i,{w:"100px",h:"100px",flexDir:"column",children:e.jsx(U,{objectFit:"cover",src:p})}),e.jsx(T,{}),e.jsxs(i,{flexDir:"column",w:"70%",h:"100px",children:[e.jsx(n,{...F,noOfLines:1,children:l}),e.jsx(T,{}),e.jsx(n,{...s,children:o}),e.jsxs(n,{...s,children:["Purchased: ",D(a==null?void 0:a.updatedAt).fromNow()]})]})]}),d&&e.jsxs(i,{w:"30%",h:"70%",flexDir:"column",align:"flex-end",children:[e.jsx(n,{...s,color:"dark",children:"Expires"}),e.jsx(n,{...s,children:D(a==null?void 0:a.updatedAt).format("DD MMM YYYY")})]}),e.jsxs(i,{w:"30%",h:"70%",align:"flex-end",flexDir:"column",children:[e.jsx(O,{...s,as:S,_hover:{bg:"dark"},color:"light",w:"35%",h:"30%",isDisabled:!(a!=null&&a.coupon),bg:"dark",onClick:()=>{_(`${Z}/dashboard_my_deals_details`,{state:{...a}})},children:"View details"}),e.jsx(n,{as:"button",...s,opacity:a!=null&&a.couponId?1:.4,onClick:()=>{a.couponId&&L()},children:d?"View voucher":"Leave Review"}),e.jsx(n,{as:a!=null&&a.isRedeemed?"text":"button",...s,children:a!=null&&a.isRedeemed?"Redeemed":`Status: ${a.status}`}),e.jsx(n,{as:"button",...s,children:"Buy it again"})]})]}),e.jsx(R,{}),e.jsxs(ee,{isOpen:M,onClose:j,closeOnOverlayClick:!0,children:[e.jsx(n,{mb:"24px",children:"Leave review"}),e.jsx(R,{}),e.jsxs(i,{mt:"16px",mb:"16px",flexDir:"column",justify:"center",alignItems:"center",children:[e.jsx(n,{children:"My overall rating"}),e.jsx(i,{children:e.jsx(te,{name:"rate2",starColor:"#000000",emptyStarColor:"#999999",starCount:5,value:m,onStarClick:t=>{w(t)}})})]}),e.jsx(R,{}),e.jsxs(i,{mt:"20px",flexDir:"column",children:[e.jsx(i,{w:"100%",children:e.jsx(ae,{variant:"outline",borderRadius:"0px",value:g,onChange:({target:t})=>y(t.value),h:"46px",placeholder:"Review headline or summary",_placeholder:{opacity:1,color:"#AFAFAF"}})}),e.jsx(i,{mt:"16px",w:"100%",flexDir:"column",children:e.jsx(A,{variant:"outline",borderRadius:"0px",value:v,onChange:({target:t})=>b(t.value),placeholder:"Write your review here. It must be at least 5 characters long.",_placeholder:{opacity:1,color:"#AFAFAF"},size:"sm"})})]}),e.jsx(i,{align:"center",mt:"24px",children:e.jsx(S,{isLoading:N,w:"100%",h:"48px",bg:"black",_hover:{bg:"dark"},onClick:()=>q(),children:e.jsx(n,{color:"white",children:"Submit"})})}),e.jsx(i,{align:"center",mt:"10px",children:e.jsx(O,{as:"button",w:"100%",h:"48px",border:"1px solid black",onClick:()=>{w(null),b(""),y(""),j()},children:e.jsx(n,{color:"black",children:"Cancel"})})})]})]})},oe=()=>({root:{w:"100%",h:"150px",justify:"space-between"},headText:{fontSize:"16px"},bodyText:{fontSize:"12px",color:"#999999"}});export{re as default};
