import{aU as fe,aV as we,j as e,aW as Q,aX as je,r as a,_ as V,a as be,b as ge,$ as ye,u as Se,d as ee,bi as Ce,bm as ve,bn as Ee,aS as Pe,S as C,m as Re,h as x,H as m,T as i,C as f,V as se,F as l,aC as _e,aD as ke,ao as L,I as v,f as D,aE as Oe,G as Ae,b9 as Be,bo as Ie,bp as Le,y as z,aq as oe,i as De,W as ze,bq as Me,g as Fe,B as Ve,t as We,a2 as M,br as $e}from"./index-f182da16.js";import"./index-6224491c.js";import{P as Ne}from"./chunk-RLMGYZLY-fe9b2848.js";import{S as Te}from"./chunk-3RSXBRAN-7d4ccc22.js";import{P as Ue,a as He}from"./chunk-I5V4ORUK-a69dd49c.js";import"./formik.esm-8df3450b.js";var F=(r,t)=>t?`${r}.${t}, ${t}`:void 0;function ae(r){var t;const{bg:w,bgColor:W,backgroundColor:c,shadow:j,boxShadow:d,shadowColor:P}=r,{getArrowProps:R,getArrowInnerProps:n}=fe(),_=we(),k=(t=w??W)!=null?t:c,O=j??d;return e.jsx(Q.div,{...R(),className:"chakra-popover__arrow-positioner",children:e.jsx(Q.div,{className:je("chakra-popover__arrow",r.className),...n(r),__css:{"--popper-arrow-shadow-color":F("colors",P),"--popper-arrow-bg":F("colors",k),"--popper-arrow-shadow":F("shadows",O),..._.arrow}})})}ae.displayName="PopoverArrow";const E=a.lazy(()=>V(()=>import("./index-f182da16.js").then(r=>r.cW),["assets/index-f182da16.js","assets/index-ed5220eb.css"])),Xe=a.lazy(()=>V(()=>import("./index-0856bdfd.js"),["assets/index-0856bdfd.js","assets/index-f182da16.js","assets/index-ed5220eb.css"])),qe=a.lazy(()=>V(()=>import("./index-f182da16.js").then(r=>r.cX),["assets/index-f182da16.js","assets/index-ed5220eb.css"])),Ge=()=>{var Y,Z;const r=be(),t=ge(),{isOpen:w,onOpen:W,onClose:c}=ye();let j=Se();const{token:d}=ee(s=>s.authReducer),{setUpWallet:P,loading:R}=Ce(),{user_data:n}=ee(s=>s==null?void 0:s.userReducer),[_]=ve(),[k]=Ee();Pe();const[O,b]=a.useState(0),[$,N]=a.useState(!1),[re,T]=a.useState(""),[U,g]=a.useState(""),[te,H]=a.useState(!1),[X,y]=a.useState(!1),[p,q]=a.useState(""),[ne,ie]=a.useState(""),[o,Ze]=a.useState({}),[A,B]=a.useState(""),{root:le,head:S,desc:u,rewardBox:ce,search:I,Box1:de,center1:pe,pintf1:ue}=Ye();async function he(){p.includes("@")&&(H(!0),await k({rewardId:o.id,emailCode:re}).then(s=>{var h,J,K;if(s.error){g((J=(h=s==null?void 0:s.error)==null?void 0:h.data)==null?void 0:J.error);return}(K=s==null?void 0:s.data)!=null&&K.synced&&(M(t,"Brand connected successfully"),setTimeout(()=>{r($e({token:d})),T(""),q(""),y(!1),b(2)},300))}).catch(s=>{console.log(s,"SendEmailVerificationForSyncERR")}).finally(()=>{H(!1)}))}async function xe(){p.includes("@")&&(N(!0),await _({rewardId:o.id,email:p}).then(s=>{s!=null&&s.data&&(y(!0),M(t,"OTP sent successfully"))}).catch(s=>{console.log(s,"ERR")}).finally(()=>{N(!1)}))}const me=()=>{switch(O){case 0:return e.jsxs(x,{children:[e.jsxs(l,{flexDir:"row",justify:"space-between",children:[e.jsxs(m,{...S,children:["Sync ",o==null?void 0:o.name," Rewards"]}),e.jsx(f,{as:"button",onClick:c,children:e.jsx(v,{w:"30px",h:"30px",src:D.cancel_icon})})]}),e.jsxs(l,{flexDir:"row",align:"center",justify:"space-between",py:"2%",children:[e.jsxs(f,{w:"100px",h:"100px",overflow:"hidden",children:[e.jsx(v,{borderRadius:"10px",objectFit:"contain",src:o==null?void 0:o.rewardImage}),e.jsx(L,{...de,pos:"absolute"})]}),e.jsx(i,{...u,noOfLines:4,w:"100%",pl:"3%",children:o==null?void 0:o.description})]}),e.jsx(m,{...S,children:"What youâ€™ll get"}),e.jsx(l,{flexDir:"column",bg:"#f6f6f6",p:"5%",borderRadius:"15px",children:[`Authorize Me app to access your reward balance with ${o==null?void 0:o.brandName}`,`Me app will Read reward balance from ${o==null?void 0:o.brandName}`,"Me app will monitor changes in reward balance "].map(s=>e.jsxs(l,{children:[e.jsx(f,{...pe,children:e.jsx(ze,{as:Me,color:"light"})}),e.jsx(i,{...u,noOfLines:2,pl:"2%",w:"100%",children:s})]},z()))}),e.jsx(E,{isLoading:$,onClick:()=>b(1),name:`Connect with ${(o==null?void 0:o.rewardName)||"reward"}`})]});case 1:return e.jsxs(x,{children:[e.jsxs(l,{flexDir:"row",justify:"space-between",children:[e.jsx(m,{...S,children:"Verify identity "}),e.jsx(f,{as:"button",onClick:()=>{b(0),c(),B(""),y(!1),g("")},children:e.jsx(v,{src:D.cancel_icon,w:"30px",h:"30px"})})]}),e.jsx(i,{...u,w:"100%",pt:"1%",children:"Please select your preferred means of identification from the available options below"}),e.jsx(l,{...I,children:e.jsx(Le,{my:"5px",children:e.jsx(Te,{color:"dark",onChange:({target:s})=>{B(s.value)},value:A,variant:"unstyled",placeholder:"Select verification option",size:"md",_placeholder:{color:"#999999"},children:["Email","Phone number"].map(s=>e.jsx("option",{value:s,children:s},z()))})})}),A&&e.jsx(x,{children:A==="Email"?e.jsx(oe,{...I,value:p,onChange:s=>{q(s.target.value)},placeholder:"Enter email address"}):e.jsx(oe,{...I,value:ne,onChange:s=>{ie(s.target.value)},placeholder:"Enter phone number"})}),X&&e.jsxs(L,{my:"3%",children:[e.jsx(i,{fontSize:"10px",children:"Please provide the OTP sent to your inbox"}),e.jsx(De,{w:"100%",h:"60px",children:e.jsx(Ue,{onComplete:s=>{T(s),g("")},otp:!0,placeholder:"*",children:[1,2,3,4,5,6].map(()=>e.jsx(He,{...ue},z()))})})]}),U&&e.jsx(i,{...u,color:"red",children:U}),e.jsx(E,{isLoading:te||$,onClick:()=>{if(X){he();return}xe()},isDisabled:!p.includes("@"),name:"Continue"})]});case 2:return e.jsx(x,{w:"100%",children:e.jsxs(se,{children:[e.jsx(Be,{style:{width:"150px",height:"150px"},animationData:Ie,loop:!1,autoplay:!0}),e.jsx(m,{fontSize:"18px",pb:"10px",children:"Brand connected successfully"}),e.jsx(E,{name:"Ok",onClick:()=>{b(0),c(),B(""),y(!1),g(""),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}})]})})}},G=async()=>{try{const s=await P({persist:!1});s.publicAddress&&await Fe.put(`${Ve}/customer/setup-wallet-address`,{walletAddress:s.publicAddress},{headers:{Authorization:`Bearer ${d}`}}).then(({data:h})=>{d&&r(We({token:d})),M(t,"Profile updated successfully",2e3)}).catch(h=>{console.log(h,"UPDATeYUSERZRR")})}catch(s){console.log(s,"CREATE_WALLET ERR")}};return e.jsx(e.Fragment,{children:e.jsxs(a.Suspense,{fallback:e.jsx(C,{size:"sm"}),children:[e.jsx(a.Suspense,{fallback:e.jsx(C,{size:"sm"}),children:e.jsx(Xe,{pos:"relative"})}),e.jsx(Re,{children:e.jsxs(x,{...le,w:"100%",children:[e.jsx(m,{...S,children:"Sync rewards from the brands you love"}),e.jsx(i,{...u,children:"Connect your favorite brands to import rewards and get exclusive deals."}),e.jsxs(f,{as:se,...ce,children:[e.jsxs(l,{w:{base:"90%",md:"65%"},flexDir:"column",align:"center",children:[(Y=n==null?void 0:n.customer)!=null&&Y.walletAddress?e.jsx(i,{fontSize:"14px",mb:"10px",color:"red.600",as:"button",onClick:G,children:"You have already set up your wallet"}):e.jsxs(e.Fragment,{children:[R?e.jsx(C,{size:"sm"}):e.jsx(i,{textDecoration:"underline",fontSize:"14px",mb:"10px",as:"button",onClick:G,children:"Set up your wallet"})," "]}),e.jsxs(_e,{placement:"right-end",children:[e.jsx(ke,{children:e.jsx(L,{as:"button",children:e.jsx(v,{src:D.noticeIcon,w:{base:5,md:5},h:{base:5,md:5}})})}),e.jsxs(Oe,{borderRadius:20,borderColor:"grey",children:[e.jsx(ae,{}),e.jsx(Ne,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mattis, est eu tempor accumsan, lorem nulla auctor ex, a consectetur nisi mi nec justo. Cras eu nunc et dui suscipit venenatis."})]})]})]}),e.jsx(a.Suspense,{fallback:e.jsx(C,{size:"sm"}),children:e.jsx(E,{isDisabled:!((Z=n==null?void 0:n.customer)!=null&&Z.walletAddress),rest:{w:{base:"90%",md:"50%"}},name:"Proceed",onClick:()=>j(`${Ae}/dashboard`)})})]})]})}),e.jsx(qe,{isOpen:w,onClose:c,closeOnOverlayClick:!1,children:me()})]})})},as=Ge,Ye=()=>({root:{w:"100%",pt:"3%",overflow:"hidden"},head:{fontSize:{base:"18px",md:"20px"}},desc:{pb:"5px",fontSize:{base:"12px",md:"14px"},w:{base:"100%",md:"80%"}},smallerDesc:{fontSize:{base:"10px",md:"14px"}},rewardBox:{w:"100%",bg:"grey",borderRadius:10,borderWidth:1,borderColor:"placeholderColor",borderStyle:"dashed",py:"2%"},connectButton:{w:{base:"65%",md:"90%"},color:"dark",borderWidth:0,backgroundColor:"light",alignSelf:"center",justifySelf:"center"},connectedButton:{w:{base:"65%",md:"35%"},color:"light",borderWidth:1,backgroundColor:"transparent"},search:{w:"100%",h:"40px",background:"#F6F6F6",borderRadius:"53px",justify:"flex-start",align:"center",pl:"2%",borderWidth:"0px",_placeholder:{color:"#999999"},_focus:{borderColor:"black"}},Box1:{w:"100px",h:"100px",borderRadius:"100px",bg:"#9999992D"},center1:{bg:"#000000",w:"20px",h:"20px",borderRadius:"20px"},pintf1:{bg:"grey",borderRadius:10,borderWidth:0,w:"15%",h:"100%"}});export{as as default};
