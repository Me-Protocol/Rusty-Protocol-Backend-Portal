import{r as o,_,a as Ee,b as Oe,O as N,u as ke,d as q,ap as ve,aq as Re,ar as _e,as as Le,at as ze,j as e,S as u,m as Y,h as l,H as c,T as t,C as h,V as k,F as n,G as Q,z as X,au as Z,I as v,f as J,av as Pe,q as R,aj as K,a7 as ee,i as Be,E as Ie,aw as Me,g as Ae,B as De,ax as Fe,W as se,ay as Ve}from"./index-dcfd6306.js";import"./index-4207a9a5.js";import We from"./index-72082709.js";import{S as Te}from"./chunk-3RSXBRAN-78614f9f.js";import{P as Ue,a as $e}from"./chunk-I5V4ORUK-f362d1b4.js";import"./formik.esm-1438a09a.js";import"./index-22181dac.js";import"./index-fa241765.js";import"./ResizeObserver.es-f4289e8a.js";import"./ReactCardFlip-7f77b88b.js";const m=o.lazy(()=>_(()=>import("./index-dcfd6306.js").then(i=>i.de),["assets/index-dcfd6306.js","assets/index-56f23032.css"])),Ge=o.lazy(()=>_(()=>import("./index-8ef13738.js"),["assets/index-8ef13738.js","assets/index-dcfd6306.js","assets/index-56f23032.css"])),ae=o.lazy(()=>_(()=>import("./index-dcfd6306.js").then(i=>i.df),["assets/index-dcfd6306.js","assets/index-56f23032.css"])),He=()=>{var W,T,U,$;const i=Ee(),L=Oe(),{isOpen:oe,onOpen:qe,onClose:f}=N(),{isOpen:ne,onOpen:re,onClose:z}=N();let P=ke();const{token:j}=q(s=>s.authReducer),{setUpWallet:te,loading:ie}=ve(),{user_data:r}=q(s=>s==null?void 0:s.userReducer),{data:S,isLoading:Ye}=Re({page:1,limit:7},{refetchOnMountOrArgChange:!0}),[le]=_e(),[ce]=Le();ze();const[de,w]=o.useState(0),[B,I]=o.useState(!1),[pe,M]=o.useState(""),[A,b]=o.useState(""),[xe,D]=o.useState(!1),[F,g]=o.useState(!1),[d,V]=o.useState(""),[ue,he]=o.useState(""),[a,Qe]=o.useState({}),[C,E]=o.useState(""),{root:me,head:y,desc:p,rewardBox:fe,search:O,Box1:je,center1:we,pintf1:be}=Ne();async function ge(){d.includes("@")&&(D(!0),await ce({rewardId:a.id,emailCode:pe}).then(s=>{var x,G,H;if(s.error){b((G=(x=s==null?void 0:s.error)==null?void 0:x.data)==null?void 0:G.error);return}(H=s==null?void 0:s.data)!=null&&H.synced&&(se(L,"Brand connected successfully"),setTimeout(()=>{i(Ve({token:j})),M(""),V(""),g(!1),w(2)},300))}).catch(s=>{console.log(s,"SendEmailVerificationForSyncERR")}).finally(()=>{D(!1)}))}async function ye(){d.includes("@")&&(I(!0),await le({rewardId:a.id,email:d}).then(s=>{s!=null&&s.data&&(g(!0),se(L,"OTP sent successfully"))}).catch(s=>{console.log(s,"ERR")}).finally(()=>{I(!1)}))}const Se=()=>{switch(de){case 0:return e.jsxs(l,{children:[e.jsxs(n,{flexDir:"row",justify:"space-between",children:[e.jsxs(c,{...y,children:["Sync ",a==null?void 0:a.name," Rewards"]}),e.jsx(h,{as:"button",onClick:f,children:e.jsx(v,{w:"30px",h:"30px",src:J.cancel_icon})})]}),e.jsxs(n,{flexDir:"row",align:"center",justify:"space-between",py:"2%",children:[e.jsxs(h,{w:"100px",h:"100px",overflow:"hidden",children:[e.jsx(v,{borderRadius:"10px",objectFit:"contain",src:a==null?void 0:a.rewardImage}),e.jsx(ee,{...je,pos:"absolute"})]}),e.jsx(t,{...p,noOfLines:4,w:"100%",pl:"3%",children:a==null?void 0:a.description})]}),e.jsx(c,{...y,children:"What you’ll get"}),e.jsx(n,{flexDir:"column",bg:"#f6f6f6",p:"5%",borderRadius:"15px",children:[`Authorize Me app to access your reward balance with ${a==null?void 0:a.brandName}`,`Me app will Read reward balance from ${a==null?void 0:a.brandName}`,"Me app will monitor changes in reward balance "].map(s=>e.jsxs(n,{children:[e.jsx(h,{...we,children:e.jsx(Ie,{as:Me,color:"light"})}),e.jsx(t,{...p,noOfLines:2,pl:"2%",w:"100%",children:s})]},R()))}),e.jsx(m,{isLoading:B,onClick:()=>w(1),name:`Connect with ${(a==null?void 0:a.rewardName)||"reward"}`})]});case 1:return e.jsxs(l,{children:[e.jsxs(n,{flexDir:"row",justify:"space-between",children:[e.jsx(c,{...y,children:"Verify identity "}),e.jsx(h,{as:"button",onClick:()=>{w(0),f(),E(""),g(!1),b("")},children:e.jsx(v,{src:J.cancel_icon,w:"30px",h:"30px"})})]}),e.jsx(t,{...p,w:"100%",pt:"1%",children:"Please select your preferred means of identification from the available options below"}),e.jsx(n,{...O,children:e.jsx(Pe,{my:"5px",children:e.jsx(Te,{color:"dark",onChange:({target:s})=>{E(s.value)},value:C,variant:"unstyled",placeholder:"Select verification option",size:"md",_placeholder:{color:"#999999"},children:["Email","Phone number"].map(s=>e.jsx("option",{value:s,children:s},R()))})})}),C&&e.jsx(l,{children:C==="Email"?e.jsx(K,{...O,value:d,onChange:s=>{V(s.target.value)},placeholder:"Enter email address"}):e.jsx(K,{...O,value:ue,onChange:s=>{he(s.target.value)},placeholder:"Enter phone number"})}),F&&e.jsxs(ee,{my:"3%",children:[e.jsx(t,{fontSize:"10px",children:"Please provide the OTP sent to your inbox"}),e.jsx(Be,{w:"100%",h:"60px",children:e.jsx(Ue,{onComplete:s=>{M(s),b("")},otp:!0,placeholder:"*",children:[1,2,3,4,5,6].map(()=>e.jsx($e,{...be},R()))})})]}),A&&e.jsx(t,{...p,color:"red",children:A}),e.jsx(m,{isLoading:xe||B,onClick:()=>{if(F){ge();return}ye()},isDisabled:!d.includes("@"),name:"Continue"})]});case 2:return e.jsx(l,{w:"100%",children:e.jsxs(k,{children:[e.jsx(X,{style:{width:"150px",height:"150px"},animationData:Z,loop:!1,autoplay:!0}),e.jsx(c,{fontSize:"18px",pb:"10px",children:"Brand connected successfully"}),e.jsx(m,{name:"Ok",onClick:()=>{w(0),f(),E(""),g(!1),b(""),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}})]})})}},Ce=async()=>{try{const s=await te({persist:!1});s.publicAddress&&await Ae.put(`${De}/customer/setup-wallet-address`,{walletAddress:s.publicAddress},{headers:{Authorization:`Bearer ${j}`}}).then(({data:x})=>{j&&i(Fe({token:j})),re()}).catch(x=>{console.log(x,"UPDATeYUSERZRR")})}catch(s){console.log(s,"CREATE_WALLET ERR")}};return e.jsx(e.Fragment,{children:e.jsxs(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:[e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(Ge,{pos:"relative"})}),e.jsx(Y,{children:e.jsxs(l,{mt:"3rem",...me,w:"100%",children:[e.jsx(c,{...y,children:"Let’s sync your account with brands on our network"}),e.jsx(t,{...p,children:"Connect your favorite brands to import rewards and get exclusive deals."}),e.jsxs(h,{as:k,...fe,children:[e.jsx(n,{w:{base:"90%",md:"65%"},flexDir:"column",align:"center",children:e.jsx(Y,{alignSelf:"center",children:e.jsx(n,{w:"100%",display:{base:"none",md:"flex"},flexDir:"column",mt:5,alignSelf:"center",children:e.jsx(n,{children:e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(We,{brandsItems:(W=S==null?void 0:S.data)==null?void 0:W.brands})})})})})}),e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(m,{isDisabled:!!((T=r==null?void 0:r.customer)!=null&&T.walletAddress),rest:{w:{base:"90%",md:"50%"},mt:"30px"},isLoading:ie,name:"Proceed",onClick:Ce})}),e.jsx(n,{w:{base:"90%",md:"50%"},justifyContent:"center",onClick:()=>P(`${Q}/dashboard`),color:((U=r==null?void 0:r.customer)==null?void 0:U.walletAddress)??"placeholderColor",_hover:{color:"dark"},children:($=r==null?void 0:r.customer)!=null&&$.walletAddress?e.jsxs(t,{fontSize:{base:"14px",md:"16px"},children:["You have already synced your rewards."," ",e.jsxs(t,{as:"button",_hover:{color:"dark"},color:"placeholderColor",fontSize:{base:"14px",md:"16px"},children:[" ","Go to dashboard"]})]}):e.jsx(t,{as:"button",fontSize:{base:"14px",md:"16px"},children:"Do it later"})})]})]})}),e.jsx(ae,{isOpen:oe,onClose:f,closeOnOverlayClick:!1,children:Se()}),e.jsx(ae,{isOpen:ne,onClose:z,closeOnOverlayClick:!0,children:e.jsx(l,{w:"100%",children:e.jsxs(k,{children:[e.jsx(X,{style:{width:"150px",height:"150px"},animationData:Z,loop:!1,autoplay:!0}),e.jsx(c,{fontSize:"18px",pb:"10px",children:"Successful"}),e.jsx(o.Suspense,{fallback:e.jsx(u,{size:"sm"}),children:e.jsx(m,{name:"Ok",onClick:async()=>{P(`${Q}/dashboard`),z()}})})]})})})]})})},ts=He,Ne=()=>({root:{w:"100%",pt:"3%",overflow:"hidden"},head:{fontSize:{base:"18px",md:"20px"}},desc:{pb:"5px",fontSize:{base:"12px",md:"14px"},w:{base:"100%",md:"80%"}},smallerDesc:{fontSize:{base:"10px",md:"14px"}},rewardBox:{w:"100%",bg:"grey",borderRadius:10,borderWidth:1,borderColor:"placeholderColor",borderStyle:"dashed",py:"10%"},connectButton:{w:{base:"65%",md:"90%"},color:"dark",borderWidth:0,backgroundColor:"light",alignSelf:"center",justifySelf:"center"},connectedButton:{w:{base:"65%",md:"35%"},color:"light",borderWidth:1,backgroundColor:"transparent"},search:{w:"100%",h:"40px",background:"#F6F6F6",borderRadius:"53px",justify:"flex-start",align:"center",pl:"2%",borderWidth:"0px",_placeholder:{color:"#999999"},_focus:{borderColor:"black"}},Box1:{w:"100px",h:"100px",borderRadius:"100px",bg:"#9999992D"},center1:{bg:"#000000",w:"20px",h:"20px",borderRadius:"20px"},pintf1:{bg:"grey",borderRadius:10,borderWidth:0,w:"15%",h:"100%"}});export{ts as default};
